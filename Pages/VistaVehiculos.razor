@page "/vistavehiculos"
@inject IVehiculos Vehiculos
@inject IJSRuntime js

<div class="row justify-content-center">
    <div class="col-md-8 text-center">
        <h1 class="alert alert-info">Vista de Vehículos</h1>
    </div>
</div>


<div class="row">
  @if(lsVehiculos != null){
    @foreach (var item in lsVehiculos)
    {
      <div class="col-12 col-sm-2 col-md-3">
        <div class="card shadow p-3 mb-5 bg-body rounded" style="width: 18rem;">
          <img src="https://www.motor.com.co/files/article_multimedia/uploads/2018/07/19/5b50eafc9e808.jpeg" class="card-img-top" alt="...">
          <div class="card-body">
            <h3 class="card-title text-center">@item.marca @item.modelo</h3>
            <p class="card-text">
              <table class="table tablePer">
                <tbody>
                  <tr>
                    <th>Año:</th>
                    <td>@item.anio</td>    
                  </tr>
                  <tr>
                    <th>Matricula:</th>
                    <td>@item.matricula</td>  
                  </tr>
                </tbody>
              </table>
              <h5 class="text-center" style="font-weight: bold;">DOP $@item.precio</h5>
            </p>
              <div class="text-center">
                <a href="#" class="btn btn-success"><i class="oi oi-eye"></i></a>
                <a href="/registrarvehiculo/editarvehiculo/@item.id" class="btn btn-primary"><i class="oi oi-pencil"></i></a>
                <button class="btn btn-danger" @onclick="(() => Delete(item.id))"><i class="oi oi-trash"></i></button>
              </div>
          </div>
        </div>
      </div>   
    }
  }
</div>

<!-- Button trigger modal -->
<button type="button" class="btn btn-primary" data-bs-toggle="modal" data-bs-target="#exampleModal">
  Launch demo modal
</button>

<!-- Modal -->
<div class="modal fade" id="exampleModal" tabindex="-1" aria-labelledby="exampleModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-dialog-centered modal-dialog-scrollable">
    <div class="modal-content">
      <div class="modal-header">
        <h5 class="modal-title" id="exampleModalLabel">Modal title</h5>
        <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
      </div>
      <div class="modal-body">
        ...
      </div>
      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Close</button>
        <button type="button" class="btn btn-primary">Save changes</button>
      </div>
    </div>
  </div>
</div>

@code{

  List<VehiculosDb> lsVehiculos = new List<VehiculosDb>();

  protected async override Task OnInitializedAsync()
  {
      lsVehiculos = await Vehiculos.GetVehiculos();
  }

  public async Task Delete(int id){
    var confimacion = await js.InvokeAsync<bool>("msjConfim", "Confimar", "Seguro de borrar el Vehículo?", "question");
    if(confimacion){
      await Vehiculos.DeleteVehiculo(id);
      await js.InvokeAsync<object>("msjAlert", "Eliminación Exitosa", "success");
      lsVehiculos = await Vehiculos.GetVehiculos();
    }
  }

}            